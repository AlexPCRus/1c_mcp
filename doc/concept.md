## Для чего

Доступ к tool-ам, реализованным в 1С через MCP. В 1С нет возможности держать долгое соединение и передавать данные чанками (для реализации SSE), поэтому используется прокси на Python.

## Кратко — как всё работает

1. **MCP-proxy (Python)** реализует внешний протокол MCP: принимает SSE-подписки и POST-сообщения, а внутри делает обычные HTTP-запросы в 1С.
2. **1С-слой** - это расширение MCP-сервер. В этом расширении есть HTTP-сервис mcp_APIBackend, который публикует всего два универсальных URL (`/mcp/health` и `/mcp/rpc`). Он сам формирует JSON-манифест и выполняет любой tool по имени.
3. Tool-ы описываются в обработках-контейнерах тулов (включены в подсистему mcp_КонтейнерыИнструментов), реализующих стандартный программный интерфейс; достаточно создать новую обработку, реализовать в ней методы программного интерфейса. В прокси ничего менять не нужно, он универсальный.

## Компоненты и их ответственность

### 1.  Thin MCP-proxy

- Реализуется на Python
- Может запускаться как в режиме HTTP-сервера, так и в режиме Stdio.
- В режиме HTTP-сервера принимает SSE-подписки и POST-сообщения, а внутри делает обычные HTTP-запросы в 1С.
- Принимает на вход параметры:
  - URL базы 1С
  - Имя пользователя
  - Пароль
  - Порт сервера (для HTTP-сервера)
  
### 2.  HTTP-сервис «MCP» в 1С

HTTP-сервис с корневым URL `/mcp`, в нем два шаблона:

| URL         | Метод | Что делает  |
| ----------- | ----- | ----------- |
| `/health`   | GET   | Проверяет состояние сервиса, возвращает `{"status": "ok"}` |
| `/rpc`      | POST  | Разбирает JSON-RPC, выдает список tool-ов, вызывает нужный tool |

